id: wordpress-sensitive-files

info:
  name: WordPress Sensitive Files
  author: SKrulll
  severity: medium
  description: Detects sensitive files in WordPress installations that can expose configuration details, backup files, and other potentially sensitive information.
  tags:
    - wordpress
    - exposure
    - config
    - cms

checks:
  - method: GET
    path: /wp-config.php.bak
    matchers:
      - type: word
        part: body
        value: "DB_PASSWORD"
        
  - method: GET
    path: /wp-config.php.old
    matchers:
      - type: word
        part: body
        value: "DB_PASSWORD"
        
  - method: GET
    path: /wp-config.php~
    matchers:
      - type: word
        part: body
        value: "DB_PASSWORD"
        
  - method: GET
    path: /.wp-config.php.swp
    matchers:
      - type: binary
        part: body
        value: "57 6f 72 64 50 72 65 73 73" # "WordPress" in hex
        
  - method: GET
    path: /wp-content/debug.log
    matchers:
      - type: word
        part: body
        value: "PHP"
        
  - method: GET
    path: /wp-admin/maint/repair.php
    matchers:
      - type: word
        part: body
        value: "repair database"